%% Forward solve
%
% By *** -- 18/05/2018
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~%

function [Fu, J] = forward_solve(x, model)

    Fu = feval(model.F, x);
    
    if nargout > 1
       J = [ ( 2*( x(1) - 1 - 200*x(1)*(x(2) - x(1)^2) ) ) ...
           / ( 1 + x(1)^2 - 2*x(1) + 100*(x(2) - x(1)^2)^2 ), ...
           ( 200*(x(2) - x(1)^2) ) ...
           / ( 1 + x(1)^2 - 2*x(1) + 100*(x(2) - x(1)^2)^2 ) ]; 
    end
        
     
end